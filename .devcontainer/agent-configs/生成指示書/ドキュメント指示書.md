# ドキュメント指示書

## 1. 概要

ワークスペース内のすべてのファイルを分析し、包括的なプロジェクトドキュメントを生成する。

ドキュメントは以下の手順で実行する：

1. 必要情報の読み込み
2. ドキュメント構成の確認
3. タスク分割
4. ドキュメントの生成

下記でそれぞれの手順の詳細を説明する。

---

## 2. 手順詳細

### 手順1: 必要情報の読み込み

以下の情報を自動収集する：

#### 1.1 プロジェクト基本情報
- プロジェクト名、説明（README、ビルドファイルから抽出）
- 使用言語（ファイル拡張子から判定）
- ビルドツール（build.gradle, package.json, pom.xml等）

#### 1.2 ソースコード
- **メインコード**: `src/`, `lib/`, `app/`, `pkg/` 等の標準ディレクトリ
- **設定ファイル**: application.properties, .env, config.yaml等
- **ビュー/テンプレート**: *.jsp, *.html, *.vue, *.jsx等
- **テストコード**: `test/`, `tests/`, `spec/` ディレクトリ

#### 1.3 インフラ・デプロイ
- Docker: Dockerfile, docker-compose.yml
- CI/CD: .github/workflows/, .gitlab-ci.yml等
- クラウド設定: vercel.json, netlify.toml等

#### 1.4 データ構造
- ORM定義（Entity, Model等）
- マイグレーション、スキーマファイル
- 初期データ（seeds, data.sql等）

#### 1.5 既存ドキュメント
- README.md, CONTRIBUTING.md
- docs/, wiki/ ディレクトリ
- API仕様（openapi.yaml, swagger.json）

#### 1.6 自動除外
以下は読み込みをスキップ：
- `node_modules/`, `vendor/`, `.venv/`, `build/`, `dist/`, `target/`
- `.git/`, バイナリファイル、ログファイル

### 手順2: ドキュメント構成の確認

#### 2.1 構成ファイルの確認

プロジェクトルート配下の`生成指示書/ドキュメント構成.md`の存在を確認：

**存在する場合：**
- ファイル内容を完全に読み込み
- 各セクションの順序・内容を厳密に守る
- セクション番号の重複や誤りは自動修正する

**存在しない場合：**
- AIが自動的にコード構造を分析し、ドキュメント構造を決定する
- シンボル・ファイル類似性・トピックで論理的にグループ化する

#### 2.2 優先度の考慮

構成ファイルに`priority`フィールドがある場合、その順序で処理する。

---

### 手順3: タスク分割

ドキュメント構成に基づいて、以下の手順でタスク管理を実施：

#### 3.1 タスクリストの作成

- `manage_todo_list` ツールを使用
- ドキュメント構成の各ページを個別のタスクとして登録
  - タスクタイトル例: "00-目次.md を作成"、"01-概要.md を作成"
- 全タスクのステータスを `not-started` で初期化

**タスクリスト例:**
```
1. [not-started] 00-目次.md を作成
2. [not-started] 01-概要.md を作成
3. [not-started] 02-クイックスタート.md を作成
...
```

#### 3.2 進捗管理のルール

- 作成開始前に該当タスクを `in-progress` に更新
- ページ作成完了後、即座に該当タスクを `completed` に更新
- 次のページに進む前に、必ず完了状態を記録
- ユーザーが現在の進捗状況を把握できるようにする

---

### 手順4: ドキュメントの生成

3で作成したタスクリストに従い、1ページずつドキュメントを生成する。

#### 4.1 出力形式とファイル配置

- **フォーマット**: Markdown形式
- **ファイル構成**: セクションごとに個別ファイルとして作成
- **配置場所**: `wiki/` ディレクトリ（存在しない場合は自動作成）
- **ファイル命名規則**: 
  - ドキュメント構成の各セクションタイトルをファイル名に変換
  - スペースはハイフン（-）に置換
  - 数字接頭辞を保持
    - 例: 「1. 概要」→ `wiki/01-概要.md`
    - 例: 「2. クイックスタート」→ `wiki/02-クイックスタート.md`

#### 4.2 目次ファイルの作成

- **ファイル名**: `wiki/00-目次.md`
- **内容**: 
  - プロジェクト全体の目次
  - 各ページへのリンク一覧
  - 簡単なナビゲーションガイド

**目次ファイルの例:**
```markdown
# Todo List Wiki

## 📚 目次

- [📖 1. 概要](./01-概要.md)
- [🚀 2. クイックスタート](./02-クイックスタート.md)
- [🏗️ 3. アーキテクチャ](./03-アーキテクチャ.md)
- [📁 4. リポジトリ構造](./04-リポジトリ構造.md)
- [🗄️ 5. データモデル](./05-データモデル.md)
...
```

#### 4.3 作成の流れ

**各ページ作成の流れ:**
1. `manage_todo_list` でタスクを `in-progress` に更新
2. ページを作成
3. `manage_todo_list` でタスクを `completed` に更新
4. 次のタスクに進む

**完全実行:** 全タスク完了まで中断せず継続。1ページ作成 → `completed` 更新 → 次ページ作成を繰り返し、全ページを完遂する。

#### 4.4 出力ルール（厳守）

1. **見出しと絵文字**
   - 各ファイルの冒頭（H1）に適切な絵文字を配置
   - サブセクションは H2, H3, H4 で階層化

2. **ファイル間リンク**
   - 他のセクションへの参照は相対パスで記述
     - 例: `詳細は [アーキテクチャ](./03-アーキテクチャ.md) を参照`

3. **図表の記述**
   - Mermaid図は必ず ` ```mermaid ``` ` で囲む
   - 各ページに適切な図を配置

4. **コードスニペット**
   - 言語指定付きコードブロック
   - 重要行にコメントを追加
   - ファイルパスと行番号を明記

5. **ソースコード参照**
   - プロジェクトルートからの相対パスで記述
   - 行番号範囲を含める
     - 例: `(../src/main/java/jp/co/app/todo/model/Todo.java:15-30)`

6. **一貫性**
   - 全ファイルで記述スタイルを統一
   - 用語の使い方を統一

#### 4.5 生成されるファイル構成例

```
wiki/
├── README.md (または 00-目次.md)      # 目次・ナビゲーション
├── 01-概要.md                         # プロジェクト概要
├── 02-クイックスタート.md              # セットアップ手順
├── 03-アーキテクチャ.md                # システム構成
├── 04-リポジトリ構造.md                # ディレクトリ構造
├── 05-データモデル.md                  # DB設計
├── 06-コアコンポーネント.md            # 主要クラス解説
├── 07-APIドキュメント.md               # エンドポイント仕様
├── 08-テスト戦略.md                    # テスト構成
├── 09-デプロイメント.md                # ビルド・デプロイ手順
├── 10-コントリビューションガイド.md     # 開発ガイド
└── 11-まとめ.md                       # 総括
``` 
各ページで関連するソースコードファイルへのリンクを明記する。
